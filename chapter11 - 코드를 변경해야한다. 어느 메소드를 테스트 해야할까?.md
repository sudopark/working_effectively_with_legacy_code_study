### 테스트코드를 어디에 추가해야할까?

- 테스트가 없는 레거시에대해 테스트를 추가한다면 -> 모든 메소드를 테스트하는 문서화 테스트를 생각할수있음

  => 하지만 레거시는 그리 쉽게 덜 복잡하지 않음

- 테스트 추가시 고려대상

  - 어떠한 변경을 수행하려는것인가
  - 어떤 영향을 미칠것인가
  - 영향받는것이 다른부분에 또 어떤 영향을 미칠것인가 등



### 1. 영향 추론

: 만일 어떤 메소드의 내부 변수하나가(반환값 계산에 쓰이는) 변경되었을때 호출지점에 영향이 갈것이고 또 이와 관련있는 부분에도 영향을 끼칠것이다.

#### 영향 스케치 그리기

- 영향을 받을 수 있는 변수와 메소드를 그리고 변수값 변경으로 인해 반환값이 바뀔수있는 부분을 연결
- 긜고 영향받는부분 탐색, 가능성 제거



### 2. 전방추론

: 문서화 테스트시에는 주로 객체를 먼저 조사하고 해당 객체가 제대로 작동하지 않을때 어떤 영향을 미치게 되는지 조사함

- 변경하려는꼭지를 잡고 이를 호출하는 지점 탐색, 호출되었을때 발생하는 사이드이팩트 탐색
- 영향 스케치를 그리고 호출로인해 제일 많은부분을 아우르는 지점을 탐색?
- 그리고 상속등에 의해 동작이 변경됨을 방지하기위해 접근제한자도 적절히 걸기

=> 테스트의 위치를 찾아야 할때는 어디서 변경을 탐지할수있는지 탐색하고(변경의 영향이 무엇인지) 그리고 그 중 하나를 골라 테스트 추가



### 3.  영향 전파

- 영향 전파는 기본적으로 다음의 3가지 방법을 이용해 이루어짐
  1. 호출 코드가 사용하는 반환값
  2. 매개변수로 전달된 객체를 변경 -> 지양
  3. 정적 또는 전역 변수를 변경 -> 지양

- 반환값을 지니는 메소드의 영향전파를 파악하기가 더 쉬움
- 하지만 전역변수나 정적변수에 의한 은밀한 전파는 어려움..
- 언어 특성에따라 이용할수있는 방법(접근제한자 등)으로 탐색해야할 지점을 줄일수있음



### 4. 영향 스케치의 단순화

- 영향스케치에서 중복을 제거하고 종점의 수를 줄이자

- 영향과 캡슐화

  : 캡슐화에 의해 객체 내부에서 암묵적으로 이루어지는 부분(의존관계나)를 테스트하기위해 주입과같이 캠슐화를 와해하는 경우

  => 이경우 경로 추적도 해야하지만 서술적인 테스트 루틴이 생겨 결론적으로는 더 쉬워짐

  => **테스트케이스에 의한 추론방식이 더 쉽다**

  => 캡슐화와 테스트 범위가 대립하는 상황에서 테스트 범위를 주로 선택, 이것이 추후 캡슐화를 하기에도 더 쉬워짐, 캡슐화는 그 자체가 목적이 아니라 단지 이해를 돕기위한 도구
